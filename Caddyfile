{
    on_demand_tls {
        ask http://ethernal.internal:8080/api/caddy/validDomain
    }
    
}

*.tryethernal.com, tryethernal.com {
    tls {
        on_demand
    }

    handle /api/* {
      reverse_proxy ethernal.internal:8080
    }

    handle_path /bull* {
      reverse_proxy ethernal.internal:8080
    }

    # WebSocket traffic (Soketi)
    handle /app* {
      reverse_proxy ethernal-soketi:6001 {
        header_up Upgrade "websocket"
        header_up Connection "Upgrade"
      }
    }

    encode gzip
}
